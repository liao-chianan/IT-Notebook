
### è³‡æ–™æ—¥æœŸ2023-12

## é‡ç½®äº¤æ›å™¨
en
write erase   
è¼¸å…¥yç¢ºèªé‡ç½®  
reload

## ç”¨consoleç·šé€£æ¥è¨­å®š
éš¨ä¾¿æ‰¾ä¸€æ¢mini usb cableé€£æ¥å‰æ–¹portèˆ‡ç­†é›»  
æœƒè‡ªå‹•æŠ“åˆ°serial port (com01æˆ–å…¶ä»–)ï¼Œ ç”¨putty è¨­å®šå¥½é€£ä¸Šå»  
åˆå§‹ç•«é¢æœƒå‡ºç¾
Would you like to enter the initial configuration dialog?     
è¼¸å…¥no é€²è¡Œæ‰‹å‹•è¨­å®š  

## è¨­å®šhostnameèˆ‡domain  
en  
conf t  
hostname cisco-9200  
ip domain name syps.tp.edu.tw  
end  

## å•Ÿç”¨ç¬¬ä¸‰æ–¹å…‰çº–æ¨¡çµ„æ”¯æ´  
en  
conf t   
service unsupported-transceiver  
no errdisable detect cause gbic-invalid  
end  

## æ–°å¢ç‰¹æ¬Šä½¿ç”¨è€…èˆ‡å¯†ç¢¼(å¢åŠ å®‰å…¨æ€§æ”¹ç”¨secretä¸å†ç”¨password)  
en  
conf t   
username admin001 privilege 15 secret pass0001  
username admin002 privilege 15 secret pass0002  
end  


## è¨­å®šconsole , vty telnet , ssh éƒ½å¿…é ˆè¼¸å…¥å¸³è™Ÿå¯†ç¢¼ï¼Œé ç«¯ç™»å…¥é™åˆ¶åªèƒ½ä½¿ç”¨ssh  
(5åˆ†é˜timeoutå¾Œè‡ªå‹•æ–·ç·š)  
en  
conf t   
line con 0  
 exec-timeout 5 0  
 login local  
line vty 0 4  
 exec-timeout 5 0  
 login local  
line vty 5 15  
 exec-timeout 5 0  
 login local  
 transport input ssh  
end  


## å»ºç«‹rsaå¯†é‘°(sshåŠŸèƒ½ï¼Œé•·åº¦å»ºè­°2048ä»¥ä¸Š)  
en  
conf t  
crypto key generate rsa modulus 2048  
end  

## ç¦æ­¢ç”¨webé€£ç·š(å…ˆé–‹å•Ÿhttpæ¡æœ¬åœ°å¸³è™Ÿé©—è­‰å‚™ç”¨)  
en  
conf t  
no ip http server  
no ip http secure-server  
ip http authentication local  
end  

## è¨­å®šmanagement vlan,ip,netmask,port   
(å‡è¨­manage vlan æ˜¯77 ï¼Œ ipæ˜¯192.168.77.3/23)  
en  
conf t  
vlan 77  
name management_vlan  
interface Vlan 77  
ip address 192.168.77.37 255.255.254.0  
end  

## è¨­å®šdefault gatewayèˆ‡dns  
(å‡è¨­gatewayæ˜¯192.168.77.254ï¼ŒDNSæ˜¯192.168.77.1)  
en  
conf t  
ip default-gateway 192.168.77.254   
ip name-server 192.168.77.1  
end  

## å› ç‚ºæ˜¯poe äº¤æ›å™¨ä¸‹æ¸¸ç‚ºAPäº¤æ›å™¨ï¼Œæ‰€ä»¥å…ˆæŠŠæ‰€æœ‰portéƒ½è¨­å®šæˆtrunkæ¨¡å¼  
(å…ˆå…è¨±æ‰€æœ‰çš„portè®“vlan 1 é€šé)  
en    
conf t  
int range gigabitEthernet 1/0/1-24  
switchport mode trunk  
switchport trunk allowed vlan add 1  
exit  
int range  te1/1/1-4  
switchport trunk allowed vlan add 1  
switchport mode trunk  
end  

## è¨­å®šå…‰çº–çš„4å€‹portéƒ½å…è¨±management vlanèˆ‡ä¸‹è¡Œvlan é€šé  
(ä¸åŠ allowed æœƒè®“æ‰€æœ‰vlanæµé‡é€šé)  
en  
conf t  
int range  te1/1/1-4  
switchport mode trunk  
end  

## æ¥è‘—è¨­å®šå„portéœ€è¦é€šéçš„ssid vlanèˆ‡management vlan   
(å‡è¨­port 1-12æ˜¯è¦ çµ¦APç”¨çš„ï¼Œè¦é–‹æ”¾çš„vlan æœ‰60ã€70ã€80ã€90ï¼Œä»¥åŠmanagement vlan 77)  
en  
conf t  
vlan 60  
vlan 70  
vlan 80  
vlan 90  
vlan 77  

int range gigabitEthernet 1/0/1-12  
switchport mode trunk  
switchport trunk allowed vlan 1,60,70,80,90,77  
exit  
int range gigabitEthernet 1/0/13-24  
switchport mode trunk  
switchport trunk allowed vlan 1  
end  

### æ¸¬è©¦pingå…§éƒ¨èˆ‡å¤–éƒ¨æ˜¯å¦æœ‰é€š  
ping ip 192.168.77.254 repeat 3  
ping ip dns.google.com repeat 3  


## è¨­å®šntp server(å°ç£çš„ntp)  
en  
conf t  
ntp server 118.163.81.62  
end  

### è¨­å®šæ™‚å€(GMT +8)  
en  
conf t  
clock timezone gmt +8  
end  

### æª¢æ¸¬ntpç‹€æ…‹èˆ‡æ™‚é–“ç‹€æ…‹  
show ntp associations  
show clock detail  


## è¨­å®šsnmpåŠŸèƒ½  
(å‡è¨­è¦è¨­å®šçš„community stringç‚ºlibrenms-snmp)  
en  
conf t  
snmp-server community librenms-snmp  
snmp-server enable traps snmp  
end  
  
## è¨­å®šsyslogåŠŸèƒ½ï¼Œå°‡logä¸Ÿåˆ°é ç«¯server  
(å‡è¨­syslog serverç‚º192.168.77.3)  
en  
conf t  
logging rate-limit 10000  
logging host 192.168.77.3  
end  

## é—œé–‰cdp  é–‹å•Ÿlldp  
en  
conf t  
no cdp run  
lldp run  
end  

### æª¢æ¸¬lldp ç›¸é„°è£ç½®  
show lldp neighbors  


---------------------------------
## è¨­å®šstpæ¨¡å¼ç‚ºmstp  (mstpèˆ‡rstpäºŒé¸ä¸€ï¼Œè¦–è‡ªå·±çš„ç’°å¢ƒ)  
en  
conf t  
spanning-tree mode mst  
spanning-tree loopguard default  
spanning-tree extend system-id  
spanning-tree mst configuration  
name syps-mst  
end  

-------------------------------

## è¨­å®šstpæ¨¡å¼ç‚ºrstp (mstpèˆ‡rstpäºŒé¸ä¸€ï¼Œè¦–è‡ªå·±çš„ç’°å¢ƒ)  
en  
conf t  
spanning-tree mode rapid-pvst  
spanning-tree loopguard default  
end  

------------------------------

### æª¢æ¸¬stpè¨­å®šï¼Œç¢ºèªroot æ˜¯å¦æ­£ç¢º  
show spanning-tree  


## è¨­å®šä¸‹è¡Œporté–‹å•ŸloopdetectåŠŸèƒ½ï¼Œé˜²æ­¢å–®port loop(5ç§’åµæ¸¬ä¸€æ¬¡)
### (ciscoçš„Loopdetectèˆ‡STPæ˜¯2é¸1ï¼Œå…¨åŸŸé–‹äº†STPé‚£loopdetectå°±æ²’ä½œç”¨)  
  
en  
conf t  
int range gigabitEthernet 1/0/1-24  
loopdetect  
loopdetect 5


## ç¢ºèªå„porté–‹å•Ÿloopdetectçš„ç‹€æ…‹  
show loopdetect  

## è¨­å®šå› ç‚ºstp/loopdetecté€ æˆçš„port erræœƒåœ¨åœç”¨å¾Œè‡ªå‹•å›å¾©(45ç§’)  
en  
conf t  
errdisable recovery cause bpduguard  
errdisable recovery cause psecure-violation  
errdisable recovery cause loopdetect  
errdisable recovery interval 45  
end  

## æª¢æ¸¬æ˜¯å¦æœ‰é–‹å•Ÿerrdisable recovery  
show errdisable recovery  



## è¨­å®šipv4 igmpèˆ‡ipv6 mldæå‡ç¾¤æ’­æ•ˆèƒ½ (å…¨åŸŸé–‹å•Ÿ)  
en  
conf t  
ip igmp snooping  
ipv6 mld snooping  
no ipv6 unicast-routing  
end  


## è¨­å®šæ‰€æœ‰çš„vlanéƒ½èµ°igmp v3ä¸¦å•Ÿç”¨v2 immediate leave  
en  
conf t  
ip igmp snooping vlan 1 immediate-leave  
ip igmp snooping vlan 60 immediate-leave  
ip igmp snooping vlan 70 immediate-leave  
ip igmp snooping vlan 80 immediate-leave  
ip igmp snooping vlan 90 immediate-leave  
ip igmp snooping vlan 77 immediate-leave  
int vlan 1  
ip igmp version 3  
int vlan 60  
ip igmp version 3  
int vlan 70  
ip igmp version 3  
int vlan 80  
ip igmp version 3  
int vlan 90  
ip igmp version 3  
int vlan 77  
ip igmp version 3  
end  

## æª¢æ¸¬igmp/mldç‹€æ…‹(è¦æœ‰è·‘multicastçš„clienté€£ä¸Šæ‰æœƒæœ‰è³‡æ–™)  
show ip igmp snooping   
show ip igmp snooping groups  
show ip igmp snooping querier    
show ipv6 mld snooping  
show ipv6 mld snooping address   
show ipv6 mld snooping querier  


## ç§»é™¤default vlan 1çš„è‡ªå‹•å–å¾—ipè¨­å®šï¼Œé¿å…è¢«ä»»æ„å­˜å–  
en  
conf t  
int vlan 1  
no  ip address dhcp  
no  ipv6 address autoconfig  
no  ipv6 enable  
no  ipv6 nd autoconfig default-route  
no  ipv6 dhcp client request vendor  
end  

## å°‡è¨­å®šæª”å¯«å›é–‹æ©ŸåŸ·è¡Œ  
copy run start  

------------------------------------
## æª¢æŸ¥æŒ‡ä»¤  
------------------------------------
### æª¢æŸ¥poeä¾›é›»ç‹€æ…‹  
show power inline   

### æª¢æŸ¥ç¡¬é«”è£ç½®  
show hardware  

### æª¢æŸ¥éŸŒé«”è³‡è¨Š  
show software authenticity running  
show license  summary  

### æª¢æŸ¥ç³»çµ±è² è¼‰
show processes cpu sorted  
show memory summary  


## å‚™ä»½è¨­å®šæª”æ¡ˆåˆ°tftp  
copy run tfp  
è¼¸å…¥tftp server ip  
è¼¸å…¥ç›®éŒ„èˆ‡æª”æ¡ˆåç¨±  


--------------------------

  
firmware ç¶²ç«™(æ“”å¿ƒéŸŒé«”æœ‰å•é¡Œå¯ä»¥è·Ÿå®˜ç¶²æä¾›çš„crc hashå°ç…§ä¸€ä¸‹)
https://cios.dhitechnical.com/C9200_9300_9400_9500_9600/

## æœ€ç°¡å–®æ˜¯æ‰“é–‹http serveré€éç¶²é ä»‹é¢æ“ä½œ  

## é€éå‡ç´šæŒ‡ä»¤(tftpæˆ–usbéš¨èº«ç¢Ÿçš†å¯)  
 
å…ˆæ¸…ç©ºæ²’ä½¿ç”¨çš„æª”æ¡ˆ  
install remove inactive  


å¦‚æœç”¨tftpè¦å…ˆè¨­å®šå¥½IPæ‰èƒ½ç¶²è·¯å‚³æª”æ¡ˆ  
(å‡è¨­tftp ipç‚º 192.168.77.87ï¼ŒéŸŒé«”æª”æ¡ˆcat9k_lite_iosxe.17.13.01.SPA.bin)  
copy tftp://192.168.77.87/cat9k_lite_iosxe.17.13.01.SPA.bin flash:    
  
(å‚³é€ä¸å¿«ï¼Œè¦çœ‹æª”æ¡ˆå‚³è¼¸å¤§å°å¯ä»¥ç”¨diræŒ‡ä»¤ç¢ºèª)  
```
dir flash:*.bin
```
  
å¦‚æœç”¨éš¨èº«ç¢Ÿå‚³è¼¸è¨˜å¾—éš¨èº«ç¢Ÿè¦fat32æ‰è®€å¾—åˆ°  
(å‡è¨­æ¥åˆ°ç¬¬ä¸€å€‹USB portï¼ŒéŸŒé«”æª”æ¡ˆcat9k_lite_iosxe.17.13.01.SPA.bin)   
copy usbflash0://192.168.77.87/cat9k_lite_iosxe.17.13.01.SPA.bin flash:  
éç¨‹æœƒæœ‰é€²åº¦æ¢ï¼Œè¦ç­‰ä¸€é™£å­   

æŒ‡å®šé–‹æ©Ÿè·‘çš„packagesè¨­å®šæª”æ¡ˆ  
en  
conf t  
boot system flash:packages.conf  
no boot manual   
end  
write memory

ç¢ºèªé–‹æ©Ÿè¨­å®šæœ‰packages.conf  
show boot  

é–‹å§‹å®‰è£éŸŒé«”  
install add file flash:cat9k_lite_iosxe.17.13.01.SPA.bin activate commit  
æœƒå•y/né¸æ“‡è¦ä¸è¦ä¿ç•™ç›®å‰è¨­å®šï¼Œä¹‹å¾Œè¦ç­‰ä¸Šè »é•·ä¸€æ®µæ™‚é–“  
æœ€å¾Œæœƒå•è¦ä¸è¦é¸reload system é¸æ“‡y  

  
ç¢ºèªæª”æ¡ˆå®‰è£ç‹€æ…‹
```  
dir flash:*.pkg
```

ç¢ºèªæ–°çš„éŸŒé«”æ˜¯å¦activateèˆ‡commit  
show install active  
show install commit  


éƒ½æ²’å•é¡Œå¾Œå†æ¬¡é‡é–‹æ©Ÿ  

reload


å‡ç´šæˆåŠŸå¾Œå¦‚æœè¦ç§»é™¤èˆŠæª”æ¸…å‡ºç©ºé–“  
install remove inactive    
ç¢ºèªåˆ—å‡ºæª”æ¡ˆå¾Œé¸yå³å¯  
